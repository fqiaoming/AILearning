![数据处理](./images/data_processing.svg)
*图：提示词版本管理的最佳实践*

# 第14课：提示词版本管理与团队协作

> 📚 **课程信息**
> - 所属模块：第一模块 - AI基础与环境搭建  
> - 章节：第3章 - 提示词工程精通（第7/8课）
> - 学习目标：掌握提示词的版本控制、文档化和团队协作最佳实践
> - 预计时间：50-60分钟
> - 前置知识：第08-13课

---

## 📢 课程导入

### 前言

你改了一个提示词，效果变差了，想回到之前的版本，结果发现找不到了！或者团队里三个人都在改同一个提示词，最后谁也不知道哪个是最新版！这些问题你遇到过吗？

提示词看起来只是几行文字，但在实际项目中，它会不断迭代、多人协作、需要回滚、需要文档。如果没有规范的版本管理，项目很快就会一团糟！今天我要教你的，就是如何像管理代码一样管理提示词！

---

### 核心价值点

**第一，提示词需要版本控制，就像代码一样。**

很多人以为提示词就是临时写的文本，随便改改就行。错！专业团队都会对提示词进行严格的版本管理：
- 每次修改都要记录
- 重要版本要打tag
- 出问题能立即回滚
- 知道谁改了什么

就像代码用Git管理一样，提示词也需要版本控制。大公司的AI团队，提示词都是存在Git仓库里的，每次改动都要commit、review、测试通过才能合并！

**第二，好的文档能让团队效率提升十倍。**

想象一个场景：新同事加入团队，接手一个AI项目，打开提示词文件，看到一堆字，完全不知道：
- 这个提示词是干什么的？
- 为什么这样写？
- 改过几次？每次改了什么？
- 有什么注意事项？

如果有完善的文档，这些问题一目了然！新人能快速上手，不会踩坑，也不会破坏已有的优化成果。这就是文档的价值！

**第三，团队协作需要明确的规范和流程。**

多人协作时最怕的就是：
- 你改了一版，我改了一版，不知道用哪个
- 你在测试的提示词，我不知道还以为是最终版
- 改完忘了告诉别人，上线出了问题

专业团队会建立清晰的协作规范：
- 谁负责哪个提示词
- 改动需要谁审核
- 测试通过了才能上线
- 上线要通知相关人员

有了这些规范，团队才能高效协作！

**第四，这些能力在面试中特别加分。**

面试官问："你们团队如何管理提示词？"

菜鸟回答："就放在代码里，想到了就改改"

高手回答："我们用Git管理，每个提示词有文档、有测试、有版本历史。改动要走PR流程，经过review和测试才能合并。我们还建立了提示词库，团队成员可以复用优秀的模板。"

你觉得面试官会选谁？

---

### 行动号召

今天这一课会教你：
- 如何用Git管理提示词
- 提示词文档的编写规范
- 团队协作的最佳实践
- 提示词库的建设
- Code Review的方法

**学完这课，你的提示词工程将达到企业级水平！**

---

## 📖 知识讲解

### 1. 为什么需要版本管理？

#
![Input Output](./images/input_output.svg)
*图：Input Output*

### 1.1 真实痛点

```
场景1：无法回滚
你：这个新版本效果不好，用回旧版吧
同事：旧版是什么样的？
你：忘了...
→ 损失：浪费时间重新优化

场景2：不知道谁改的
产品：为什么提示词变了？输出格式不对了！
你：不是我改的啊
→ 结果：推诿扯皮，问题无法追踪

场景3：协作冲突
你改了A版本，测试通过
同事不知道，用了B版本
→ 结果：你的优化白做了

场景4：知识流失
老员工离职，新人接手
新人：这个提示词为什么这样写？
答：不知道，前人写的
→ 结果：不敢改，怕改坏
```

---

### 2. Git版本控制

#### 2.1 项目结构设计

```
ai_project/
├── prompts/                    # 提示词目录
│   ├── classification/         # 分类任务
│   │   ├── sentiment.md       # 情感分类
│   │   └── intent.md          # 意图识别
│   ├── generation/            # 生成任务
│   │   ├── article.md         # 文章生成
│   │   └── summary.md         # 摘要生成
│   └── templates/             # 通用模板
│       ├── few_shot.md
│       └── cot.md
├── tests/                      # 测试文件
│   ├── test_sentiment.py
│   └── test_data/
│       └── sentiment.json
├── docs/                       # 文档
│   ├── prompt_guidelines.md   # 编写规范
│   └── changelog.md           # 变更日志
├── .gitignore
├── README.md
└── requirements.txt
```

---

#### 2.2 提示词文件格式

**标准格式：**

```markdown
# 情感分类提示词

## 元信息
- 版本：v2.1
- 创建时间：2024-01-15
- 最后更新：2024-03-20
- 负责人：@张三
- 审核人：@李四
- 状态：生产环境

## 功能描述
判断用户评论的情感倾向（正面/负面/中性）

## 使用场景
- 电商产品评论分析
- 用户反馈情绪识别
- 舆情监控

## 性能指标
- 准确率：88%（目标≥85%）
- F1分数：0.86
- 平均响应时间：1.2s

## 提示词内容

\```
任务：判断评论的情感倾向（正面/负面/中性）

要点：
- 综合考虑所有内容，不要只看单个词
- 注意反讽和语气
- 混合情感倾向中性

示例1：
评论：这个真的超级棒！
情感：正面

示例2：
评论：太失望了，不推荐
情感：负面

示例3：
评论：还行吧，一般般
情感：中性

---
评论：{input}
情感：
\```

## 变更历史

### v2.1 (2024-03-20)
- 优化：增加了反讽处理的示例
- 效果：准确率从85%提升到88%
- 修改人：@张三

### v2.0 (2024-02-10)
- 重构：改用Few-shot格式
- 效果：准确率从78%提升到85%
- 修改人：@李四

### v1.0 (2024-01-15)
- 初始版本
- 基础Zero-shot实现
- 创建人：@王五

## 已知问题
1. 对反讽的识别还不够准确（准确率75%）
2. 短文本（<5字）容易误判

## 待优化方向
- [ ] 添加更多反讽示例
- [ ] 针对短文本优化
- [ ] 尝试CoT方法提升推理能力

## 相关文档
- 测试数据：tests/test_data/sentiment.json
- 测试脚本：tests/test_sentiment.py
- 需求文档：docs/requirements/sentiment_analysis.md
```

---

#### 2.3 Git工作流

**日常工作流程：**

```bash
# 1. 创建feature分支
git checkout -b feature/improve-sentiment-prompt

# 2. 修改提示词
vim prompts/classification/sentiment.md

# 3. 运行测试
python tests/test_sentiment.py

# 4. 提交改动
git add prompts/classification/sentiment.md
git commit -m "feat(sentiment): 增加反讽处理示例

- 新增2个反讽示例
- 准确率从85%提升到88%
- 测试通过：88/100

Closes #123"

# 5. 推送并创建PR
git push origin feature/improve-sentiment-prompt
# 在GitHub/GitLab创建Pull Request

# 6. Code Review
# 等待团队成员审核

# 7. 合并到main分支
# Review通过后合并

# 8. 打tag（重要版本）
git tag -a v2.1 -m "Version 2.1: 提升反讽识别"
git push origin v2.1
```

---

#### 2.4 Commit Message规范

```
格式：
<type>(<scope>): <subject>

<body>

<footer>

类型（type）：
- feat: 新功能
- fix: 修复bug
- perf: 性能优化
- docs: 文档更新
- test: 测试相关
- refactor: 重构（不改变功能）
- style: 格式调整（不改变逻辑）

示例：
feat(sentiment): 增加Few-shot示例提升准确率

- 添加3个典型示例
- 覆盖正面、负面、中性情况
- 测试准确率从75%提升到85%

Closes #45
```

---

### 3. 团队协作规范

#### 3.1 角色分工

```
提示词所有者（Owner）：
- 负责特定提示词的维护
- 审核相关的改动
- 追踪性能指标
- 权限：最终决策权

贡献者（Contributor）：
- 提出改进建议
- 提交优化PR
- 参与测试
- 权限：提交PR

审核者（Reviewer）：
- 审核PR的质量
- 验证测试结果
- 确保规范遵守
- 权限：批准/拒绝PR

管理员（Admin）：
- 制定规范
- 管理权限
- 协调冲突
- 权限：全部
```

---

#### 3.2 PR审核清单

```
提示词PR审核检查项：

□ 功能
  - 改动的目的清晰
  - 解决了实际问题
  - 没有引入新问题

□ 质量
  - 提示词结构清晰
  - 语言表达准确
  - 示例质量高

□ 测试
  - 测试已通过
  - 准确率达标
  - 没有退化（新版不比旧版差）

□ 文档
  - 元信息已更新
  - 变更历史已记录
  - 描述清楚

□ 规范
  - 符合团队规范
  - Commit message规范
  - 文件结构正确

□ 安全
  - 没有泄露敏感信息
  - API key等已移除
```

---

#### 3.3 协作最佳实践

**实践1：小步快跑**

```
✅ 好的方式：
- 每次改动聚焦一个问题
- 改动小，容易review
- 测试快，容易验证

❌ 不好的方式：
- 一次性改10个提示词
- PR巨大，难以review
- 出问题难以定位
```

**实践2：及时沟通**

```
✅ 好的习惯：
- 改动前：在issue中说明计划
- 改动中：遇到问题及时讨论
- 改动后：通知相关人员

❌ 不好的习惯：
- 闷头改，改完丢给别人
- 不说明背景和原因
- 出问题才沟通
```

**实践3：知识共享**

```
✅ 好的团队：
- 定期分享提示词优化经验
- 文档完善，新人能快速上手
- 建立最佳实践库

❌ 不好的团队：
- 各自为战，不分享
- 知识在个人脑中
- 新人全靠自己摸索
```

---

### 4. 提示词库建设

#### 4.1 为什么需要提示词库？

```
痛点：
- 每次都从零写提示词，效率低
- 优秀的提示词技巧没有沉淀
- 不知道团队已有类似的提示词

解决：
建立提示词库，积累可复用的模板和优秀案例
```

---

#### 4.2 提示词库结构

```
prompt_library/
├── templates/                  # 模板库
│   ├── frameworks/             # 框架模板
│   │   ├── rtcf.md
│   │   ├── crispe.md
│   │   └── costar.md
│   ├── techniques/             # 技巧模板
│   │   ├── few_shot.md
│   │   ├── cot.md
│   │   └── role_play.md
│   └── formats/                # 格式模板
│       ├── json_output.md
│       └── markdown_output.md
├── examples/                   # 示例库
│   ├── classification/         # 分类任务
│   ├── generation/             # 生成任务
│   ├── extraction/             # 抽取任务
│   └── reasoning/              # 推理任务
├── best_practices/             # 最佳实践
│   ├── dos_and_donts.md
│   ├── common_pitfalls.md
│   └── optimization_guide.md
└── index.md                    # 索引文档
```

---

#### 4.3 模板示例

**Few-shot模板：**

```markdown
# Few-shot通用模板

## 适用场景
- 需要固定格式输出
- 需要高准确率
- 有明确的输入输出模式

## 模板结构

\```
任务：[任务描述]

[可选：要点说明]

示例1：
输入：[示例输入1]
输出：[示例输出1]

示例2：
输入：[示例输入2]
输出：[示例输出2]

示例3：
输入：[示例输入3]
输出：[示例输出3]

---
输入：{user_input}
输出：
\```

## 使用建议
1. 示例数量：2-3个最佳
2. 示例质量：覆盖典型和边界情况
3. 格式一致：严格统一
4. 顺序合理：从简单到复杂

## 注意事项
- 示例太多会增加token成本
- 示例质量差会误导AI
- 格式不一致会让AI困惑

## 参考案例
- 情感分类：examples/classification/sentiment.md
- 意图识别：examples/classification/intent.md
```

---

### 5. 文档规范

#### 5.1 必备文档

```
1. README.md
   - 项目介绍
   - 快速开始
   - 目录结构
   - 贡献指南

2. GUIDELINES.md
   - 提示词编写规范
   - 命名规范
   - 测试要求
   - Review流程

3. CHANGELOG.md
   - 版本历史
   - 重大变更
   - 已知问题

4. 每个提示词的文档
   - 功能描述
   - 使用方法
   - 性能指标
   - 变更历史
```

---

## 💻 Demo案例：提示词版本管理实践

### 案例说明

建立一个规范的提示词项目，展示版本管理的最佳实践。

### 项目初始化

```bash
# 创建项目目录
mkdir ai_prompts_project
cd ai_prompts_project

# 初始化Git
git init

# 创建目录结构
mkdir -p prompts/{classification,generation,templates}
mkdir -p tests/test_data
mkdir -p docs

# 创建.gitignore
cat > .gitignore << 'EOF'
# Python
__pycache__/
*.py[cod]
*$py.class
venv/
.env

# IDE
.vscode/
.idea/
*.swp

# 测试
.pytest_cache/
*.log

# 临时文件
*.tmp
.DS_Store
EOF

# 初始commit
git add .gitignore
git commit -m "chore: 初始化项目结构"
```

---

### 创建README

创建`README.md`：

```markdown
# AI提示词项目

## 📖 项目介绍
本项目管理公司所有AI应用的提示词，包括分类、生成、抽取等任务。

## 🚀 快速开始

### 环境准备
\```bash
# 安装依赖
pip install -r requirements.txt

# 配置环境变量
cp .env.example .env
# 编辑.env，填入API密钥
\```

### 运行测试
\```bash
# 运行所有测试
python -m pytest tests/

# 运行特定测试
python tests/test_sentiment.py
\```

## 📁 目录结构
\```
├── prompts/           # 提示词文件
│   ├── classification/  # 分类任务
│   ├── generation/      # 生成任务
│   └── templates/       # 通用模板
├── tests/             # 测试文件
├── docs/              # 文档
└── README.md
\```

## 📝 贡献指南

### 提交流程
1. 创建feature分支
2. 修改提示词
3. 运行测试确保通过
4. 提交PR，等待review
5. Review通过后合并

### Commit规范
\```
<type>(<scope>): <subject>

type: feat|fix|perf|docs|test|refactor
scope: 提示词名称
subject: 简短描述
\```

### PR审核要点
- [ ] 测试已通过
- [ ] 文档已更新
- [ ] 性能未退化
- [ ] 符合编写规范

## 👥 团队成员
- @张三 - 项目负责人
- @李四 - 技术审核
- @王五 - 测试负责

## 📚 相关文档
- [提示词编写规范](docs/guidelines.md)
- [测试指南](docs/testing.md)
- [变更日志](docs/CHANGELOG.md)

## 📄 License
MIT
```

---

### 创建编写规范

创建`docs/guidelines.md`：

```markdown
# 提示词编写规范

## 1. 文件命名

### 规则
- 使用小写字母和下划线
- 名称要见名知意
- 使用.md格式

### 示例
✅ 好的命名：
- sentiment_classification.md
- article_summary.md
- user_intent_detection.md

❌ 不好的命名：
- prompt1.md
- test.md
- 未命名.md

## 2. 文件结构

### 必需部分
1. 元信息
2. 功能描述
3. 提示词内容
4. 变更历史

### 可选部分
- 使用场景
- 性能指标
- 已知问题
- 待优化方向

## 3. 提示词质量标准

### 清晰性
- 任务描述明确
- 要求具体清晰
- 避免歧义表达

### 完整性
- 包含必要的上下文
- 示例覆盖典型情况
- 边界情况有说明

### 一致性
- 术语统一
- 格式一致
- 风格统一

## 4. 测试要求

### 必须测试
- 准确率≥85%（分类任务）
- 测试集规模≥50个样本
- 覆盖边界情况

### 性能基准
- 不能低于前一版本
- 改进需有数据支持

## 5. 文档要求

### 变更记录
每次修改必须记录：
- 修改内容
- 修改原因
- 效果对比
- 修改人

### 清晰描述
- 功能描述清楚
- 使用方法明确
- 注意事项完整
```

---

### 创建示例提示词

创建`prompts/classification/sentiment.md`：

```markdown
# 情感分类提示词

## 元信息
- 版本：v1.0
- 创建时间：2024-03-20
- 负责人：@张三
- 状态：开发中

## 功能描述
判断用户评论的情感倾向

## 提示词内容

\```
任务：判断评论的情感倾向（正面/负面/中性）

示例1：
评论：这个产品真的太好了！
情感：正面

示例2：
评论：质量太差，不推荐
情感：负面

示例3：
评论：还可以吧，一般
情感：中性

---
评论：{input}
情感：
\```

## 变更历史

### v1.0 (2024-03-20)
- 初始版本
- 基础Few-shot实现
- 创建人：@张三
```

---

### Git提交流程演示

```bash
# 1. 添加新提示词
git add prompts/classification/sentiment.md
git add docs/guidelines.md
git add README.md

# 2. 提交
git commit -m "feat(sentiment): 添加情感分类提示词

- 实现基础Few-shot版本
- 添加3个典型示例
- 初始测试准确率：78%

Ref #001"

# 3. 创建测试文件
# ... 编写测试代码 ...

# 4. 优化提示词
# ... 修改sentiment.md ...

# 5. 提交优化
git commit -m "perf(sentiment): 优化示例选择

- 替换为更典型的示例
- 准确率从78%提升到85%
- 测试通过：85/100

Closes #001"

# 6. 查看历史
git log --oneline --graph

# 7. 打tag
git tag -a v1.0 -m "Release 1.0: 情感分类上线"

# 8. 查看某个版本
git show v1.0
```

---

## 🎯 最佳实践总结

### 1. 版本控制

```
✅ 使用Git管理所有提示词
✅ 每次改动都要commit
✅ 重要版本打tag
✅ 分支管理规范
✅ Commit message清晰
```

### 2. 文档完善

```
✅ 每个提示词都有文档
✅ 元信息完整
✅ 变更历史清晰
✅ 使用方法明确
✅ 定期更新
```

### 3. 团队协作

```
✅ 角色分工明确
✅ Review流程清晰
✅ 沟通及时有效
✅ 知识共享
✅ 规范统一
```

### 4. 持续改进

```
✅ 定期review提示词
✅ 收集用户反馈
✅ 追踪性能指标
✅ 优化并记录
✅ 分享经验
```

---

## ✅ 课后检验

完成本课后，你应该能够：

- [ ] 使用Git管理提示词
- [ ] 编写规范的提示词文档
- [ ] 参与团队协作和Code Review
- [ ] 建立提示词库
- [ ] 制定团队规范

---

## 📝 下一课预告

**第15课：提示词工程实战项目**

前面学了这么多理论和技巧，是时候实战了！下一课我们将：
- 从零开发一个完整的AI应用
- 应用所有学过的技巧
- 经历真实的开发流程
- 处理实际的问题和挑战

**准备好，真正的实战来了！**

---

**🎉 恭喜你完成第14课！**

你已经掌握了企业级的提示词管理方法！

**下一步：** 打开 `第15课-提示词工程实战.md`

