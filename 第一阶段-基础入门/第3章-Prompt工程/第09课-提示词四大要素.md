![模型结构](./images/model_structure.svg)
*图：提示词的四大要素构成完整的指令结构*

# 第09课：提示词的四大要素 - RTCF框架

> 📚 **课程信息**
> - 所属模块：第一模块 - AI基础与环境搭建  
> - 章节：第3章 - 提示词工程精通（第2/8课）
> - 学习目标：掌握提示词的四大核心要素，能写出结构化的高质量提示词
> - 预计时间：60-70分钟
> - 前置知识：第08课

---

## 📢 课程导入

### 前言

上一课我们说提示词工程决定AI效果的80%，但具体怎么写呢？很多人写提示词就是想到哪写到哪，毫无章法。结果就是AI理解不了你的意图，输出一塌糊涂。

其实，写好提示词是有套路的！就像写代码有设计模式一样，提示词也有经典的结构。今天我要教你一个超级实用的框架：**RTCF框架** —— Role（角色）、Task（任务）、Context（上下文）、Format（格式）。掌握这四个要素，你写的每一个提示词都会有质的飞跃！

---

### 核心价值点

**第一，RTCF框架是业界公认的提示词标准结构。**

不管是OpenAI的官方文档，还是顶级AI工程师的分享，都会提到这四个要素。为什么？因为它对应了AI理解和执行任务的底层逻辑。你按这个框架写提示词，就是在用AI最习惯的方式沟通，效果自然好！

而且这个框架简单易记：RTCF，Role Task Context Format。记住这四个单词，你随时随地都能写出高质量提示词！

**第二，四大要素不是简单罗列，而是有内在逻辑的。**

很多人知道要写角色、任务、格式，但不知道怎么组合，结果写得乱七八糟。其实它们是有严密逻辑的：
- Role定位AI的身份和能力边界
- Task明确AI要完成什么
- Context提供必要的背景信息
- Format规定输出的具体形式

这四个环环相扣，缺一不可！就像做菜，食材、调料、火候、装盘，都要有！

**第三，掌握四大要素，你的提示词成功率能提升十倍。**

我做过实验，用RTCF框架重写之前的烂提示词，成功率从30%提升到90%！为什么差距这么大？因为结构化的提示词让AI很容易理解你的意图，而随意写的提示词让AI频频猜错。

这就像给员工安排任务：你说"去办件事"，他不知道怎么办；你说"你是采购经理，去买10台电脑，预算5万，今天下午前交货"，他立刻知道怎么做。提示词也是一样的道理！

**第四，每个要素都有具体的写法技巧，学会了立即能用。**

今天这一课不仅教你理论，更重要的是教你具体怎么写！每个要素有什么常见模板？什么时候该详细写？什么时候可以省略？不同场景怎么调整？全都会告诉你！

学完这节课，你立刻就能用RTCF框架重写你所有的提示词，效果瞬间提升！

---

### 行动号召

所以今天这一课，请你：
- 理解四大要素的底层逻辑
- 记住每个要素的写法模板
- 用RTCF框架重写你之前的提示词
- 对比优化前后的效果差异

**RTCF框架是你今后写提示词的标准模板，必须熟练掌握！**

---

## 📖 知识讲解

### 1. RTCF框架概述

#
![Input Output](./images/input_output.svg)
*图：Input Output*

### 1.1 什么是RTCF

```
RTCF = Role + Task + Context + Format

R - Role（角色）：AI是谁？扮演什么角色？
T - Task（任务）：AI要做什么？具体任务是什么？
C - Context（上下文）：背景信息是什么？有什么限制？
F - Format（格式）：输出格式是什么？结构如何？
```

#### 1.2 为什么是这四个要素？

```
对应AI的思考流程：

1. Role：确定"我是谁"
   → AI激活对应的知识和语言风格

2. Task：明确"我要做什么"
   → AI确定目标和执行方向

3. Context：理解"在什么情况下"
   → AI调整策略和细节

4. Format：知道"输出成什么样"
   → AI组织内容和结构

这四步恰好是AI理解和执行任务的完整流程！
```

---

### 2. 要素一：Role（角色）

#### 2.1 Role的作用

```
定义AI的身份，影响：
✅ 专业深度
✅ 语言风格
✅ 知识范围
✅ 回答方式
```

**实例对比：**

**无角色：**
```
提示词：介绍一下Python

AI输出：
Python是一种编程语言...（泛泛而谈）
```

**有角色（初学者导师）：**
```
提示词：
你是一位耐心的Python初学者导师。
介绍一下Python。

AI输出：
Python就像是一种和电脑对话的语言，就像我们学英语一样...
（通俗易懂，适合新手）
```

**有角色（技术专家）：**
```
提示词：
你是一位有15年经验的Python专家。
介绍一下Python。

AI输出：
Python是一种动态类型、解释型的高级编程语言。它基于面向对象...
（专业深入，适合有基础的人）
```

---

#### 2.2 如何写好Role

**✅ 好的Role写法：**

```
模板1：职业 + 经验
你是一位有10年经验的Python工程师

模板2：职业 + 专长
你是一位擅长数据分析的数据科学家

模板3：职业 + 风格
你是一位风趣幽默的编程老师

模板4：多重角色
你是一位既懂技术又懂业务的产品经理

模板5：角色 + 能力边界
你是一个Python专家，但不熟悉前端开发
```

**❌ 不好的Role写法：**

```
❌ 太模糊
你是一个聪明的助手  （什么领域的？）

❌ 太夸张
你是宇宙第一Python大师  （不真实）

❌ 自相矛盾
你是一个Python新手，请给专家级建议  （矛盾）
```

---

#### 2.3 常用角色模板

**技术类：**
```
- 资深XX工程师（Python/Java/前端）
- 架构师
- 算法专家
- 数据科学家
- DevOps工程师
```

**教育类：**
```
- 耐心的XX老师
- 经验丰富的导师
- 教育专家
```

**创作类：**
```
- 专业文案撰稿人
- 创意总监
- 内容策划
- 技术博主
```

**业务类：**
```
- 产品经理
- 业务分析师
- 咨询顾问
- 项目经理
```

---

### 3. 要素二：Task（任务）

#### 3.1 Task的作用

```
明确AI要做什么，这是最核心的要素！

好的Task：
✅ 目标明确
✅ 可执行
✅ 可衡量
✅ 具体清晰
```

---

#### 3.2 如何写好Task

**✅ 好的Task写法：**

```
模板1：动词 + 对象 + 目标
编写一个Python函数，实现快速排序算法

模板2：分步骤描述
任务：
1. 分析这段代码的问题
2. 提出优化建议
3. 重写优化后的代码

模板3：输入输出明确
输入：一段英文文本
任务：翻译成中文
输出：翻译后的文本

模板4：包含成功标准
编写单元测试，要求测试覆盖率达到80%以上
```

**❌ 不好的Task写法：**

```
❌ 太模糊
帮我写点代码  （写什么代码？）

❌ 太宽泛
分析这个项目  （分析什么方面？多深入？）

❌ 不可执行
让这个系统变得更好  （如何定义"更好"？）

❌ 没有明确目标
研究一下AI  （研究什么？要什么结果？）
```

---

#### 3.3 Task的详细程度

```
根据任务复杂度决定：

简单任务：简短描述即可
"将这段英文翻译成中文"

中等任务：列出关键要求
"编写一个爬虫程序，爬取网站首页的所有文章标题和链接"

复杂任务：分步骤+详细要求
任务：开发一个用户注册功能
步骤：
1. 设计数据库表结构
2. 实现注册API接口
3. 编写输入验证逻辑
4. 添加邮箱验证功能
5. 编写单元测试
```

---

### 4. 要素三：Context（上下文）

#### 4.1 Context的作用

```
提供背景信息，帮助AI：
✅ 理解任务背景
✅ 做出合适判断
✅ 避免不必要的假设
✅ 生成更贴切的输出
```

**实例对比：**

**无Context：**
```
提示词：写一个登录功能

AI输出：
（可能生成一个简单的username/password验证）
```

**有Context：**
```
提示词：
背景：这是一个企业内部管理系统，需要支持AD域登录、
单点登录（SSO）和多因素认证（MFA）。

任务：设计登录功能的技术方案。

AI输出：
（会考虑企业级需求，给出更完整的方案）
```

---

#### 4.2 什么时候需要Context

```
需要提供Context的场景：

✅ 专业领域任务
例：这是医疗系统，需要符合HIPAA合规要求

✅ 有特殊限制
例：代码不能使用第三方库，只用标准库

✅ 有历史背景
例：这是旧系统的重构，原系统用的是Java 8

✅ 有特定受众
例：这篇文档是给C-level高管看的，不要有技术细节

✅ 有上下游依赖
例：这个模块会被其他3个系统调用，需要保证向后兼容

✅ 有性能要求
例：这个接口日均调用1000万次，响应时间要<100ms
```

---

#### 4.3 Context的常见类型

**类型1：项目背景**
```
这是一个电商平台的购物车模块，日活用户10万，
需要支持秒杀场景的高并发。
```

**类型2：技术约束**
```
技术栈：Python 3.10 + FastAPI + PostgreSQL
不允许使用ORM，需要手写SQL
```

**类型3：业务规则**
```
业务规则：
- 用户每天只能下单3次
- 单笔订单金额不超过10万
- 超过5000元需要审核
```

**类型4：历史问题**
```
当前问题：系统响应慢，用户抱怨多
已尝试方案：增加缓存，但效果不明显
```

**类型5：目标受众**
```
受众：公司技术VP，需要评估可行性和成本
文档风格：商务正式，包含ROI分析
```

---

### 5. 要素四：Format（格式）

#### 5.1 Format的作用

```
指定输出格式，确保：
✅ 输出可直接使用
✅ 结构清晰统一
✅ 易于解析处理
✅ 符合下游需求
```

**实例对比：**

**无Format：**
```
提示词：分析这段代码的问题

AI输出：
这段代码有几个问题，首先是变量命名不规范，其次是缺少
异常处理，还有性能可以优化...（一大段文字）
```

**有Format：**
```
提示词：
分析这段代码的问题

输出格式：
{
  "issues": [
    {
      "type": "代码规范",
      "description": "...",
      "severity": "low/medium/high",
      "suggestion": "..."
    }
  ]
}

AI输出：
（规范的JSON，可以直接解析使用）
```

---

#### 5.2 常用Format类型

**类型1：纯文本格式**
```
格式要求：
- 字数：500字左右
- 分段：3-4段
- 每段开头用数字标注
```

**类型2：Markdown格式**
```
格式要求：
- 使用Markdown语法
- 一级标题：# 概述
- 二级标题：## 详细内容
- 代码块用```包裹
```

**类型3：JSON格式**
```
输出格式：
{
  "name": "项目名称",
  "description": "项目描述",
  "tech_stack": ["Python", "FastAPI"],
  "estimated_time": "2周"
}
```

**类型4：代码格式**
```
输出格式：
- 语言：Python
- 包含：函数文档字符串、类型注解、单元测试
- 遵循：PEP 8规范
```

**类型5：表格格式**
```
输出格式：Markdown表格
| 功能模块 | 优先级 | 预计工时 | 负责人 |
|---------|-------|---------|-------|
| ...     | ...   | ...     | ...   |
```

---

### 6. RTCF框架完整示例

#### 示例1：代码生成任务

```
【R - Role】
你是一位有10年经验的Python后端工程师，熟悉FastAPI框架，
注重代码质量和性能。

【T - Task】
任务：实现用户注册API接口

功能要求：
1. 接收用户名、密码、邮箱
2. 验证输入合法性
3. 密码使用bcrypt加密
4. 邮箱唯一性检查
5. 返回注册结果

【C - Context】
背景：这是一个SaaS平台的用户系统，预计日活1万用户。
技术栈：Python 3.10 + FastAPI + PostgreSQL + SQLAlchemy
代码规范：遵循PEP8，类型注解完整，异常处理完善。

【F - Format】
输出格式：
1. 完整的Python代码
2. 包含类型注解
3. 包含详细注释
4. 包含至少2个单元测试用例
5. 代码结构清晰，可直接运行
```

---

#### 示例2：文案写作任务

```
【R - Role】
你是一位资深的科技媒体编辑，擅长将复杂的技术概念
转化为大众能理解的语言。

【T - Task】
任务：写一篇关于"AI大模型如何改变编程"的科普文章

内容要求：
1. 介绍AI辅助编程的现状
2. 举3个实际应用案例
3. 分析对程序员的影响
4. 展望未来趋势

【C - Context】
目标读者：对技术感兴趣的普通大众
发布平台：知乎、公众号
文章目的：科普+引流

【F - Format】
格式要求：
- 字数：1200-1500字
- 结构：开头（吸引人的钩子）+ 3个案例（每个300字）
        + 分析（200字）+ 展望（200字）
- 语言：通俗易懂，多用比喻，避免专业术语
- 风格：轻松有趣但不失严谨
```

---

#### 示例3：数据分析任务

```
【R - Role】
你是一位数据分析专家，擅长从数据中发现业务洞察。

【T - Task】
任务：分析电商平台的用户行为数据，给出优化建议

数据内容：
- 用户访问记录
- 购买转化率
- 用户留存情况

【C - Context】
业务背景：平台最近流量增长，但转化率下降，需要找原因。
当前问题：用户来了但不买，加购物车后放弃率高。
决策需求：市场部需要在下周会议上汇报优化方案。

【F - Format】
输出格式：

1. 数据概况（表格）
2. 问题诊断（3-5个核心问题）
3. 原因分析（每个问题的可能原因）
4. 优化建议（具体可执行的方案）
5. 预期效果（量化指标）

格式：Markdown，包含数据可视化建议
```

---

## 💻 Demo案例：RTCF框架实战

### 案例说明

用RTCF框架重写提示词，对比优化前后的效果。

### 代码实现

创建`rtcf_framework_demo.py`：

```python
"""
RTCF框架实战演示
对比使用RTCF框架前后的提示词效果
"""

from openai import OpenAI
import os
from dotenv import load_dotenv

load_dotenv()

client = OpenAI(
    base_url=os.getenv("LOCAL_LLM_BASE_URL"),
    api_key=os.getenv("LOCAL_LLM_API_KEY")
)


def get_response(prompt: str, temperature: float = 0.7) -> str:
    """获取AI回复"""
    response = client.chat.completions.create(
        model=os.getenv("LOCAL_LLM_MODEL"),
        messages=[{"role": "user", "content": prompt}],
        temperature=temperature,
        max_tokens=1500
    )
    return response.choices[0].message.content


def demo_code_generation():
    """演示1：代码生成任务"""
    print("\n" + "="*80)
    print("演示1：代码生成任务 - 实现用户认证功能")
    print("="*80)
    
    # 优化前：没有使用RTCF
    before = "写一个用户登录功能"
    
    print("\n【优化前：没有RTCF框架】")
    print(f"提示词：{before}")
    print("-" * 80)
    response = get_response(before, temperature=0.3)
    print(f"AI输出（前300字）：\n{response[:300]}...")
    
    # 优化后：使用RTCF
    after = """【Role - 角色】
你是一位资深的Python后端工程师，有8年Web开发经验，熟悉安全最佳实践。

【Task - 任务】
任务：实现用户登录验证功能

具体要求：
1. 函数接收用户名和密码
2. 验证用户名是否存在
3. 验证密码是否正确（假设密码已加密存储）
4. 返回登录结果和用户信息
5. 记录登录日志
6. 处理可能的异常情况

【Context - 上下文】
背景：这是一个企业管理系统的登录模块
技术栈：Python 3.10 + FastAPI
安全要求：需要防止暴力破解，登录失败3次锁定账户10分钟
数据库：假设使用SQLAlchemy ORM

【Format - 格式】
输出要求：
1. 完整的Python代码
2. 包含类型注解（typing模块）
3. 包含完整的函数文档字符串
4. 包含异常处理
5. 包含简单的使用示例
6. 代码符合PEP 8规范

请开始实现："""
    
    print("\n【优化后：使用RTCF框架】")
    print(f"提示词：\n{after}")
    print("-" * 80)
    response = get_response(after, temperature=0.3)
    print(f"AI输出：\n{response}")


def demo_content_creation():
    """演示2：内容创作任务"""
    print("\n" + "="*80)
    print("演示2：内容创作任务 - 写一篇技术博客")
    print("="*80)
    
    # 优化前
    before = "写一篇关于Python装饰器的文章"
    
    print("\n【优化前：没有RTCF框架】")
    print(f"提示词：{before}")
    print("-" * 80)
    response = get_response(before, temperature=0.7)
    print(f"AI输出（前300字）：\n{response[:300]}...")
    
    # 优化后
    after = """【Role - 角色】
你是一位Python技术博主，拥有5年Python教学经验，
擅长用生动的例子和比喻讲解技术概念。

【Task - 任务】
任务：写一篇关于Python装饰器的技术博客文章

内容要求：
1. 用一个生活中的例子引入装饰器概念
2. 解释装饰器的基本原理
3. 提供3个实用的装饰器示例：
   - 计时装饰器
   - 日志装饰器
   - 缓存装饰器
4. 每个示例包含完整代码和使用说明
5. 总结装饰器的使用场景和注意事项

【Context - 上下文】
目标读者：有Python基础但不了解装饰器的初学者
发布平台：个人技术博客
阅读时长：5-8分钟

【Format - 格式】
格式要求：
- 使用Markdown语法
- 字数：1000-1200字
- 结构：
  # 标题（吸引人）
  ## 什么是装饰器（用比喻引入）
  ## 装饰器的原理（简洁清晰）
  ## 三个实用示例（代码+说明）
  ## 总结（使用场景+注意事项）
- 代码块使用```python包裹
- 语言风格：通俗易懂，适当使用表情符号

请开始创作："""
    
    print("\n【优化后：使用RTCF框架】")
    print(f"提示词：\n{after}")
    print("-" * 80)
    response = get_response(after, temperature=0.7)
    print(f"AI输出：\n{response}")


def demo_data_analysis():
    """演示3：数据分析任务"""
    print("\n" + "="*80)
    print("演示3：数据分析任务 - 分析电商数据")
    print("="*80)
    
    # 优化前
    before = "分析这个电商数据，给建议"
    
    print("\n【优化前：没有RTCF框架】")
    print(f"提示词：{before}")
    print("-" * 80)
    response = get_response(before, temperature=0.5)
    print(f"AI输出（前300字）：\n{response[:300]}...")
    
    # 优化后
    after = """【Role - 角色】
你是一位资深的电商数据分析师，有5年行业经验，
擅长从数据中发现业务问题并提出可执行的优化方案。

【Task - 任务】
任务：分析电商平台Q4季度的运营数据，提出优化建议

数据概况：
- 总访问量：100万UV
- 注册转化率：8%
- 购买转化率：2%
- 客单价：平均150元
- 复购率：15%

【Context - 上下文】
业务背景：
- 这是一个母婴类电商平台
- Q4是销售旺季（双11、双12）
- 竞品转化率普遍在3-4%
- 公司目标：Q1转化率提升到3%

当前问题：
- 虽然流量很大，但转化率低于行业平均
- 用户停留时间短，跳出率高
- 购物车放弃率达到70%

【Format - 格式】
输出格式：

## 数据诊断
1. 与行业对标分析（表格）
2. 核心问题识别（3-5个）

## 原因分析
每个问题的可能原因（2-3个）

## 优化建议
每个问题的具体解决方案，包括：
- 方案描述
- 实施难度（低/中/高）
- 预期效果（量化）
- 优先级（P0/P1/P2）

## 行动计划
按优先级排序的实施计划（时间线）

使用Markdown格式，清晰易懂

请开始分析："""
    
    print("\n【优化后：使用RTCF框架】")
    print(f"提示词：\n{after}")
    print("-" * 80)
    response = get_response(after, temperature=0.5)
    print(f"AI输出：\n{response}")


def main():
    """主函数"""
    print("🎯 RTCF框架实战演示")
    print("="*80)
    print("对比使用RTCF框架前后的提示词效果")
    print("="*80)
    
    # 运行三个演示
    demo_code_generation()
    demo_content_creation()
    demo_data_analysis()
    
    print("\n" + "="*80)
    print("✅ 演示完成！")
    print("\n💡 核心总结：")
    print("1. RTCF框架 = Role + Task + Context + Format")
    print("2. Role: 定义AI的身份和专业度")
    print("3. Task: 明确具体要做什么（最重要）")
    print("4. Context: 提供必要的背景信息")
    print("5. Format: 指定输出的具体格式")
    print("\n6. 使用RTCF框架后，输出质量显著提升！")
    print("7. 框架不是死板的，可以根据情况灵活调整")
    print("8. 四个要素中，Task是必须的，其他可视情况增减")
    print("="*80)


if __name__ == "__main__":
    main()
```

### 运行演示

```bash
# 确保LM Studio服务运行中
# 激活虚拟环境
python rtcf_framework_demo.py
```

---

## 🎯 RTCF使用技巧

### 技巧1：不是每次都要四全

```
简单任务：可以只有Task和Format
"将这段英文翻译成中文，保持原格式"

中等任务：Task + Format + Context
"翻译这段技术文档（Context：这是API文档），
保持专业术语不翻译"

复杂任务：完整的RTCF
（参考前面的示例）
```

### 技巧2：要素顺序可以调整

```
常规顺序：R → T → C → F
（先定义角色，再说任务）

也可以：T → R → C → F
（任务最重要，先说任务）

甚至：R → C → T → F
（先铺垫背景，再说任务）

关键：逻辑清晰即可
```

### 技巧3：用分隔符增强结构

```
使用【】或---来分隔：

【Role】
你是...

【Task】
任务：...

【Context】
背景：...

【Format】
输出格式：...

这样AI更容易识别结构
```

---

## ✅ 课后检验

完成本课后，你应该能够：

- [ ] 理解RTCF四大要素的含义
- [ ] 知道每个要素的作用和重要性
- [ ] 能使用RTCF框架写提示词
- [ ] 能根据任务复杂度灵活调整
- [ ] 能识别现有提示词的不足

---

## 📝 下一课预告

**第10课：CRISPE提示词框架实战**

下一课我们将学习另一个强大的框架：
- CRISPE框架的5个要素
- 与RTCF的对比和选择
- 实际项目中的应用
- 框架组合使用技巧

**让你的提示词工程更上一层楼！**

---

**🎉 恭喜你完成第09课！**

你已经掌握了RTCF框架，这是写好提示词的基础！

**下一步：** 打开 `第10课-CRISPE框架.md`

