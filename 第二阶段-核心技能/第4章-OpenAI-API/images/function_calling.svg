<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 750 400" width="750" height="400">
  <defs>
    <marker id="arrowFC" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64b5f6"/>
    </marker>
  </defs>
  
  <rect width="750" height="400" fill="#0f0f23"/>
  <text x="375" y="35" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="20" font-weight="bold">Function Calling 工作流程</text>
  
  <!-- 步骤1: 用户请求 -->
  <rect x="30" y="70" width="140" height="80" rx="10" fill="#1a1a2e" stroke="#4ecdc4" stroke-width="2"/>
  <text x="100" y="100" text-anchor="middle" fill="#4ecdc4" font-family="Arial, sans-serif" font-size="12" font-weight="bold">👤 用户</text>
  <text x="100" y="125" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10">"北京今天天气"</text>
  
  <line x1="170" y1="110" x2="210" y2="110" stroke="#64b5f6" stroke-width="2" marker-end="url(#arrowFC)"/>
  
  <!-- 步骤2: LLM分析 -->
  <rect x="220" y="70" width="160" height="80" rx="10" fill="#16213e" stroke="#667eea" stroke-width="2"/>
  <text x="300" y="95" text-anchor="middle" fill="#667eea" font-family="Arial, sans-serif" font-size="12" font-weight="bold">🤖 LLM 分析</text>
  <text x="300" y="115" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="9">识别意图: 查询天气</text>
  <text x="300" y="130" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="9">提取参数: city=北京</text>
  
  <line x1="380" y1="110" x2="420" y2="110" stroke="#64b5f6" stroke-width="2" marker-end="url(#arrowFC)"/>
  
  <!-- 步骤3: 函数调用 -->
  <rect x="430" y="70" width="140" height="80" rx="10" fill="#1a1a2e" stroke="#ffd93d" stroke-width="2"/>
  <text x="500" y="95" text-anchor="middle" fill="#ffd93d" font-family="Arial, sans-serif" font-size="12" font-weight="bold">⚡ Function Call</text>
  <text x="500" y="120" text-anchor="middle" fill="#81c784" font-family="Courier, monospace" font-size="9">get_weather(</text>
  <text x="500" y="135" text-anchor="middle" fill="#81c784" font-family="Courier, monospace" font-size="9">  city="北京")</text>
  
  <line x1="570" y1="110" x2="610" y2="110" stroke="#64b5f6" stroke-width="2" marker-end="url(#arrowFC)"/>
  
  <!-- 步骤4: 外部API -->
  <rect x="620" y="70" width="110" height="80" rx="10" fill="#1a1a2e" stroke="#ff6b6b" stroke-width="2"/>
  <text x="675" y="100" text-anchor="middle" fill="#ff6b6b" font-family="Arial, sans-serif" font-size="12" font-weight="bold">🌐 API</text>
  <text x="675" y="125" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="9">天气服务</text>
  
  <!-- 返回流程 -->
  <path d="M 675 150 L 675 190 L 100 190 L 100 230" stroke="#81c784" stroke-width="2" fill="none" stroke-dasharray="5,5"/>
  
  <!-- 步骤5: 生成回复 -->
  <rect x="30" y="230" width="700" height="80" rx="10" fill="#16213e" stroke="#81c784" stroke-width="2"/>
  <text x="375" y="260" text-anchor="middle" fill="#81c784" font-family="Arial, sans-serif" font-size="14" font-weight="bold">📝 LLM 生成自然语言回复</text>
  <text x="375" y="290" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="12">"北京今天天气晴朗，气温 22°C，适合户外活动。"</text>
  
  <!-- 函数定义示例 -->
  <rect x="30" y="330" width="700" height="55" rx="8" fill="#1a1a2e"/>
  <text x="375" y="355" text-anchor="middle" fill="#a0a0a0" font-family="Arial, sans-serif" font-size="11">💡 函数定义: { "name": "get_weather", "parameters": { "city": "string" } }</text>
  <text x="375" y="375" text-anchor="middle" fill="#a0a0a0" font-family="Arial, sans-serif" font-size="10">LLM会根据函数schema自动决定何时调用哪个函数</text>
</svg>

